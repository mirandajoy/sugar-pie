function urlParams(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+t+"=([^&#]*)"),e=a.exec(location.search);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function floatToString(t,a){var e=t.toFixed(a).toString();return e.match(/^\.\d+/)?"0"+e:e}function attributeToString(t){return"string"!=typeof t&&"undefined"===(t+="")&&(t=""),jQuery.trim(t)}function getCookie(t){var a=document.cookie,e=a.indexOf(" "+t+"=");if(-1==e&&(e=a.indexOf(t+"=")),-1==e)a=null;else{e=a.indexOf("=",e)+1;var r=a.indexOf(";",e);-1==r&&(r=a.length),a=unescape(a.substring(e,r))}return a}"undefined"==typeof Shopify&&(Shopify={}),Shopify.formatMoney=function(t,a){function e(t){return t.replace(/(\d+)(\d{3}[\.,]?)/,"$1,$2")}"string"==typeof t&&(t=t.replace(".",""));var r="",o=/\{\{\s*(\w+)\s*\}\}/,n=a||this.money_format;switch(n.match(o)[1]){case"amount":r=e(floatToString(t/100,2));break;case"amount_no_decimals":r=e(floatToString(t/100,0));break;case"amount_with_comma_separator":r=floatToString(t/100,2).replace(/\./,",");break;case"amount_no_decimals_with_comma_separator":r=e(floatToString(t/100,0)).replace(/\./,",")}return n.replace(o,r)},Shopify.onProduct=function(){},Shopify.onCartUpdate=function(){},Shopify.updateCartNote=function(t,a){var e={type:"POST",url:"/cart/update.js",data:"note="+attributeToString(t),dataType:"json",success:function(t){"function"==typeof a?a(t):Shopify.onCartUpdate(t)},error:function(t,a){Shopify.onError(t,a)}};jQuery.ajax(e)},Shopify.onError=function(XMLHttpRequest,textStatus){var data=eval("("+XMLHttpRequest.responseText+")");data.message?alert(data.message+"("+data.status+"): "+data.description):alert("Error : "+Shopify.fullMessagesFromErrors(data).join("; ")+".")},Shopify.addItem=function(t,a,e){a=a||1;var r={type:"POST",url:"/cart/add.js",data:"quantity="+a+"&id="+t,dataType:"json",success:function(t){"function"==typeof e?e(t):Shopify.onItemAdded(t)},error:function(t,a){Shopify.onError(t,a)}};jQuery.ajax(r)},Shopify.addItemFromForm=function(t,a,e){var r={type:"POST",url:"/cart/add.js",data:jQuery(t).serialize(),dataType:"json",success:function(e){"function"==typeof a?a(e,t):Shopify.onItemAdded(e,t)},error:function(a,r){"function"==typeof e?e(a,r,t):Shopify.onError(a,r)}};jQuery.ajax(r)},Shopify.getCart=function(t){jQuery.getJSON("/cart.js",function(a){"function"==typeof t?t(a):Shopify.onCartUpdate(a)})},Shopify.getProduct=function(t,a){jQuery.getJSON("/products/"+t+".js",function(t){"function"==typeof a?a(t):Shopify.onProduct(t)})},Shopify.changeItem=function(t,a,e){var r={type:"POST",url:"/cart/change.js",data:"quantity="+a+"&line="+t,dataType:"json",success:function(t){"function"==typeof e?e(t):Shopify.onCartUpdate(t)},error:function(t,a){Shopify.onError(t,a)}};jQuery.ajax(r)};var ajaxifyShopify=function(module,$){"use strict";var init,settings,cartInit,$cssTransforms,$cssTransforms3d,$nojQueryLoad,$window,$body,$html,$pageWrapper,$wrapperClass,$formContainer,$btnClass,$windowrapperClass,$addToCart,$flipClose,$flipCart,$flipContainer,$cartCountSelector,$cartCostSelector,$drawerSelector,$toggleCartButton,$modal,$cartContainer,$modalContainer,$modalOverlay,$closeCart,$drawerContainer,$prependDrawerTo,$callbackData={},updateCountPrice,flipSetup,revertFlipButton,modalSetup,showModal,sizeModal,hideModal,drawerSetup,showDrawer,hideDrawer,loadCartImages,formOverride,itemAddedCallback,itemErrorCallback,cartUpdateCallback,setToggleButtons,flipCartUpdateCallback,buildCart,cartTemplate,adjustCart,adjustCartCallback,createQtySelectors,qtySelectors,validateQty,scrollTop,toggleCallback,debouncedChangedItem;return init=function(t){if(settings={method:"drawer",formSelector:'form[action^="/cart/add"]',cartFormSelector:'form[action^="/cart"]',addToCartSelector:'input[type="submit"]',cartCountSelector:null,cartCostSelector:null,drawerSelector:"#ajaxifyDrawer",toggleCartButton:null,btnClass:null,wrapperClass:null,useCartTemplate:!0,moneyFormat:"$",disableAjaxCart:!1,enableQtySelectors:!0,prependDrawerTo:"body",onToggleCallback:null,drawerExists:!1,line:null,qty:0},$.extend(settings,t),urlParams("method")&&(settings.method=urlParams("method")),settings.method=settings.method.toLowerCase(),$formContainer=$(settings.formSelector),$btnClass=settings.btnClass,$wrapperClass=settings.wrapperClass,$addToCart=$formContainer.find(settings.addToCartSelector),$flipContainer=null,$flipClose=null,$cartCountSelector=$(settings.cartCountSelector),$cartCostSelector=$(settings.cartCostSelector),$drawerSelector=$(settings.drawerSelector),$toggleCartButton=$(settings.toggleCartButton),$modal=null,$prependDrawerTo=$(settings.prependDrawerTo),$cssTransforms=Modernizr.csstransforms,$cssTransforms3d=Modernizr.csstransforms3d,$window=$(window),$body=$("body"),$html=$("html"),$pageWrapper=$(".page-element"),$nojQueryLoad=$html.hasClass("lt-ie9"),$nojQueryLoad&&(settings.useCartTemplate=!1),$drawerSelector.length&&(settings.drawerExists=!0),settings.enableQtySelectors&&qtySelectors(),!settings.disableAjaxCart){switch(settings.method){case"flip":flipSetup();break;case"modal":modalSetup();break;case"drawer":drawerSetup()}$(document).keyup(function(t){if(27==t.keyCode)switch(settings.method){case"flip":case"drawer":hideDrawer();break;case"modal":hideModal()}}),$addToCart.length&&formOverride()}debouncedChangedItem=_.debounce(function(){Shopify.changeItem(settings.line,settings.qty,adjustCartCallback)},250),adjustCart()},updateCountPrice=function(t){$cartCountSelector&&($cartCountSelector.html("("+t.item_count+")").removeClass("hidden-count"),0===t.item_count&&$cartCountSelector.addClass("hidden-count")),$cartCostSelector&&$cartCostSelector.html(Shopify.formatMoney(t.total_price,settings.moneyFormat))},flipSetup=function(){if(drawerSetup(),$addToCart.length){$addToCart.addClass("flip-front").wrap('<div class="flip"></div>');var t=$('<a href="/cart" class="flip-back" style="background-color: #C00; color: #fff;" id="flip-checkout">Checkout</a>').addClass($btnClass),a=$('<span class="ajaxifyCart-loader"></span>'),e=$('<div class="flip-extra"><a href="#" class="flip-cart">View Cart (<span></span>)</a></div>');t.insertAfter($addToCart),a.insertAfter(t),$flipContainer=$(".flip"),$cssTransforms3d||$flipContainer.addClass("no-transforms"),e.insertAfter($flipContainer),$flipCart=$(".flip-cart"),$flipCart.on("click",function(t){t.preventDefault(),showDrawer(!0)}),$('input[type="checkbox"], input[type="radio"], select',$formContainer).on("click",function(){revertFlipButton()})}},revertFlipButton=function(){$flipContainer.removeClass("is-flipped")},modalSetup=function(){var t=$("#modalTemplate").html(),a=Handlebars.compile(t);$body.append(a).append('<div id="ajaxifyCart-overlay"></div>'),$modalContainer=$("#ajaxifyModal"),$modalOverlay=$("#ajaxifyCart-overlay"),$cartContainer=$("#ajaxifyCart"),$modalOverlay.on("click",hideModal),$modalContainer.prepend('<a class="ajaxifyCart--close" title="Close Cart"><span class="icon-fallback-text"><span class="icon icon-cross" aria-hidden="true"></span><span class="fallback-text">Close</span></span></a>'),$closeCart=$(".ajaxifyCart--close"),$closeCart.on("click",hideModal),$cssTransforms||$modalContainer.addClass("no-transforms"),$(window).on({orientationchange:function(){$modalContainer.hasClass("is-visible")&&sizeModal("resize")},resize:function(){!$nojQueryLoad&&$modalContainer.hasClass("is-visible")&&sizeModal("resize")}}),setToggleButtons()},showModal=function(t){$body.addClass("ajaxify-modal--visible"),!cartInit&&t?Shopify.getCart(cartUpdateCallback):sizeModal()},sizeModal=function(t){t||$modalContainer.css("opacity",0),$modalContainer.css({"margin-left":-$modalContainer.outerWidth()/2,opacity:1}),$closeCart.css({top:10+$cartContainer.find("h1").height()/2}),$modalContainer.addClass("is-visible"),scrollTop()},hideModal=function(t){$body.removeClass("ajaxify-modal--visible"),t&&t.preventDefault(),$modalContainer&&($modalContainer.removeClass("is-visible"),$body.removeClass("ajaxify-lock")),toggleCallback({is_visible:!1})},drawerSetup=function(){var t=$("#drawerTemplate").html(),a=Handlebars.compile(t),e={wrapperClass:$wrapperClass};settings.drawerExists||$prependDrawerTo.prepend(a(e)),$drawerContainer=$("#ajaxifyDrawer"),$cartContainer=$("#ajaxifyCart"),$(".ajaxifyCart--close").length||$drawerContainer.prepend('<a class="ajaxifyCart--close" title="Close"><span class="icon-fallback-text"><span class="icon icon-cross" aria-hidden="true"></span><span class="fallback-text">Close</span></span></a>'),$closeCart=$(".ajaxifyCart--close"),$closeCart.on("click",hideDrawer),setToggleButtons()},showDrawer=function(t){"flip"==settings.method?Shopify.getCart(flipCartUpdateCallback):!cartInit&&t&&Shopify.getCart(cartUpdateCallback),$drawerContainer.addClass("is-visible"),$body.addClass("page-move--cart"),setTimeout(function(){$html.addClass("page-move--toggled"),$body.addClass("mobile-drawer--open")},600),$pageWrapper.on("click.mobileDrawerOpen",function(){$body.hasClass("mobile-drawer--open")&&hideDrawer()})},hideDrawer=function(){$drawerContainer.removeClass("is-visible"),$html.removeClass("page-move--toggled"),$body.removeClass("mobile-drawer--open page-move--cart"),toggleCallback({is_visible:!1}),$pageWrapper.off("click.mobileDrawerOpen")},loadCartImages=function(){var t=$("img",$cartContainer),a=t.length,e=0;t.on("load",function(){if(++e==a)switch(settings.method){case"modal":sizeModal()}})},formOverride=function(){$formContainer.submit(function(t){switch(t.preventDefault(),$addToCart.removeClass("is-added").addClass("is-adding"),$(".qty-error").remove(),Shopify.addItemFromForm(t.target,itemAddedCallback,itemErrorCallback),settings.method){case"flip":$flipContainer.addClass("flip--is-loading")}})},itemAddedCallback=function(){switch($addToCart.removeClass("is-adding").addClass("is-added"),settings.method){case"flip":setTimeout(function(){$flipContainer.removeClass("flip--is-loading").addClass("is-flipped")},600)}Shopify.getCart(cartUpdateCallback)},itemErrorCallback=function(XMLHttpRequest,textStatus,form){switch(settings.method){case"flip":$flipContainer.removeClass("flip--is-loading")}var data=eval("("+XMLHttpRequest.responseText+")");data.message&&422==data.status&&$(form).after('<div class="errors qty-error">'+data.description+"</div>")},cartUpdateCallback=function(t){switch(updateCountPrice(t),settings.method){case"flip":$(".flip-cart span").html(t.item_count);break;case"modal":buildCart(t);break;case"drawer":buildCart(t),$drawerContainer.hasClass("is-visible")?scrollTop():showDrawer()}},setToggleButtons=function(){($toggleCartButton=$(settings.toggleCartButton))&&($toggleCartButton.off("click"),$toggleCartButton.on("click",function(t){switch(t.preventDefault(),settings.method){case"modal":$modalContainer.hasClass("is-visible")?hideModal():showModal(!0);break;case"drawer":case"flip":$drawerContainer.hasClass("is-visible")?hideDrawer():showDrawer(!0)}}))},flipCartUpdateCallback=function(t){buildCart(t)},buildCart=function(t){if(settings.useCartTemplate&&0!==t.item_count||$cartContainer.empty(),0!==t.item_count){if(settings.useCartTemplate)return void cartTemplate(t);var a=[],e={},r={},o=$("#cartTemplate").html(),n=Handlebars.compile(o);switch($.each(t.items,function(t,r){var o=r.quantity+1,n=r.quantity-1,i=r.quantity,s=r.image.replace(/(\.[^.]*)$/,"_small$1").replace("http:",""),l=r.title.replace(/(\-[^-]*)$/,""),c=r.title.replace(/^[^\-]*/,"").replace(/-/,"");e={key:r.key,line:t+1,url:r.url,img:s,name:l,variation:c,itemAdd:o,itemMinus:n,itemQty:i,price:Shopify.formatMoney(r.price,settings.moneyFormat)},a.push(e)}),r={items:a,totalPrice:Shopify.formatMoney(t.total_price,settings.moneyFormat),btnClass:$btnClass},$cartContainer.append(n(r)),adjustCart(),settings.method){case"modal":loadCartImages();break;case"flip":case"drawer":t.item_count>0&&loadCartImages()}cartInit=!0}else switch($cartContainer.append('<h2 class="text-center">Your Cart</h2>').append('<p class="cart--empty-message text-center">Your cart is currently empty.</p>').append('<div class="cart--cookie-message text-center"><p>Enable cookies to use the shopping cart</p></div>'),settings.method){case"modal":sizeModal("resize")}},cartTemplate=function(t){$cartContainer.load('/cart form[action="/cart"]',function(){switch(adjustCart(),settings.method){case"modal":loadCartImages();break;case"flip":case"drawer":t.item_count>0&&loadCartImages()}cartInit=!0,toggleCallback({is_visible:!0})})},adjustCart=function(){function t(t,a){var e;e=settings.useCartTemplate?$('.cart__row[data-line="'+t+'"]').addClass("ajaxifyCart--is-loading"):$('.ajaxifyCart--row[data-line="'+t+'"]').addClass("ajaxifyCart--is-loading"),0===a&&e.addClass("is-removed"),debouncedChangedItem()}settings.useCartTemplate&&createQtySelectors();var a=$(".ajaxifyCart--qty span");a.off("click"),a.on("click",function(){var a=$(event.currentTarget),e=(a.data("id"),a.siblings(".ajaxifyCart--num"));this.line=a.data("line"),this.qty=validateQty(e.val()?parseInt(e.val().replace(/\D/g,"")):0),a.hasClass("ajaxifyCart--add")?this.qty=this.qty+1:(this.qty=this.qty-1,this.qty<=0&&(this.qty=0)),this.line?t(this.line,this.qty):e.val(this.qty)}.bind(settings));var e=$(".ajaxifyCart--num");e.off("change"),e.on("change",function(){var a=$(event.currentTarget);this.line=a.data("line"),this.qty=validateQty(parseInt(a.val().replace(/\D/g,""))),this.line&&t(this.line,this.qty)}.bind(settings)),$(settings.cartFormSelector).on("submit",function(t){"input"===document.activeElement.nodeName.toLowerCase()&&t.preventDefault()}),e.off("focus"),e.on("focus",function(){var t=$(this);setTimeout(function(){t.select()},50)}),$(".ajaxifyCart--remove").on("click",function(a){var e=$(event.currentTarget);this.line=e.data("line")||null,this.qty=0,this.line&&(a.preventDefault(),t(this.line,this.qty))}.bind(settings));var r=$('textarea[name="note"]');r.off("change"),r.on("change",function(){var t=$(this).val();Shopify.updateCartNote(t,function(){})}),window.Shopify&&Shopify.StorefrontExpressButtons&&Shopify.StorefrontExpressButtons.initialize()},adjustCartCallback=function(t){if(updateCountPrice(t),0===t.item_count)switch(settings.method){case"modal":break;case"flip":case"drawer":hideDrawer()}setTimeout(function(){Shopify.getCart(buildCart)},150)},createQtySelectors=function(){$('input[type="number"]',$cartContainer).length&&$('input[type="number"]',$cartContainer).each(function(){var t=$(this),a=parseInt(t.val()),e=a+1,r=a-1,o=a,n=$("#ajaxifyQty").html(),i=Handlebars.compile(n),s={key:t.data("id"),line:t.data("line"),itemQty:o,itemAdd:e,itemMinus:r};t.after(i(s)).remove()}),$('a[href^="/cart/change"]',$cartContainer).length&&$('a[href^="/cart/change"]',$cartContainer).each(function(){$(this).addClass("ajaxifyCart--remove")})},qtySelectors=function(){var t=$('input[type="number"]'),a=1;t.length&&(t.each(function(){var t=$(this),a=parseInt(t.val()),e=t.attr("name"),r=t.attr("id"),o=a+1,n=a-1,i=a,s=$("#jsQty").html(),l=Handlebars.compile(s),c={key:t.data("id"),itemQty:i,itemAdd:o,itemMinus:n,inputName:e,inputId:r};t.after(l(c)).remove()}),$(".js--qty-adjuster").off(),$(".js--qty-adjuster").on("click",function(){var t=$(this),e=(t.data("id"),t.siblings(".js--num")),r=parseInt(e.val().replace(/\D/g,"")),r=validateQty(r);$body.hasClass("template-cart")&&(a=0),t.hasClass("js--add")?r+=1:(r-=1)<=a&&(r=a),e.val(r)}))},validateQty=function(t){return(parseFloat(t)!=parseInt(t)||isNaN(t))&&(t=1),t},scrollTop=function(){($body.scrollTop()>0||$html.scrollTop()>0)&&$("html, body").animate({scrollTop:0},250,"swing")},toggleCallback=function(t){t.method=settings.method,"function"==typeof settings.onToggleCallback&&settings.onToggleCallback.call(this,t)},module={init:init}}(ajaxifyShopify||{},jQuery);